{"name": "LM_ResidualTransformations_Lab", "extension": ".R", "course": "MPM01", "st_mode": 33204, "st_ino": 13100116, "st_dev": 16777233, "st_nlink": 1, "st_uid": 501, "st_gid": 20, "st_size": 4732, "st_atime": 1759510056.2417202, "st_mtime": 1759494000.0, "st_ctime": 1759510056.1504266, "st_birthtime": 1759494000.0, "st_blocks": 16, "st_blksize": 4096, "content": "## ----getData---------------------------------------------\n# d.farms <- read.table(\"http://stat.ethz.ch/Teaching/Datasets/WBL/farmsAus.dat\",\n#                       header = TRUE)\n## or\nd.farms <- readRDS(\"Farms_Australia.RDS\")\nstr(d.farms)\nhead(d.farms)\n\n\n## ----plotIndustry----------------------------------------\nlibrary(ggplot2)\nggplot(data = d.farms,\n       mapping = aes(y = revenue,\n                     x = industry)) + \n  geom_boxplot()\n\n\n## ----plotRemoveOut, message=FALSE------------------------\nlibrary(dplyr) ## contains the filter() function\nggplot(data = filter(d.farms, revenue < 10^4),\n       mapping = aes(y = revenue,\n                     x = industry)) + \n  geom_boxplot()\n\n\n## ----plotRemoveOut2--------------------------------------\nggplot(data = filter(d.farms, revenue < 4000),\n       mapping = aes(y = revenue,\n                     x = industry)) + \n  geom_boxplot()\n\n\n## ----BoxpltoLogy-----------------------------------------\nggplot(data = d.farms,\n       mapping = aes(y = log(revenue),\n                     x = industry)) + \n  geom_boxplot()\n\n\n## ----ggLogRevenuVsExpenditure----------------------------\nggplot(data = d.farms,\n       mapping = aes(y = log(revenue),\n                     x = expenditure)) + \n  geom_point()\n\n\n## ----ggLogRevenuVsLogExpenditure-------------------------\nggplot(data = d.farms,\n       mapping = aes(y = log(revenue),\n                     x = log(expenditure))) + \n  geom_point()\n\n\n## ----getOzone--------------------------------------------\n# install.packages(\"gss\")\nlibrary(gss)\ndata(ozone)\n## OR\n# ozone <- readRDS(\"Ozone.RDS\")\n\n\n## ----helpOzone, eval=FALSE-------------------------------\n# ?ozone\n\n\n## ----strOzone--------------------------------------------\nstr(ozone)\nhead(ozone)\n\n\n## ----edaOzone, message=FALSE-----------------------------\n# vdht\nggplot(data = ozone,\n       mapping = aes(y = upo3,\n                     x = vdht)) + \n  geom_point() +\n  geom_smooth()\n# \n# sbtp\nggplot(data = ozone,\n       mapping = aes(y = upo3,\n                     x = sbtp)) + \n  geom_point() +\n  geom_smooth()\n##\n# ibth\nggplot(data = ozone,\n       mapping = aes(y = upo3,\n                     x = ibht)) + \n  geom_point() +\n  geom_smooth()\n\n\n## ----pairsOzone------------------------------------------\n## all plots together (quick and dirty)\npairs(upo3 ~ vdht + sbtp + ibht, data = ozone, upper.panel = panel.smooth)\n\n\n## ----lmOzone---------------------------------------------\nlm.ozone <- lm(upo3 ~ vdht + sbtp + ibht, data = ozone)\n\n\n## ----TAlmOzone-------------------------------------------\nplot(lm.ozone, which = 1)\nplot(lm.ozone, which = 3)\n\n\n## ----LmOzoneQuad-----------------------------------------\nlm.ozone.quad <- lm(upo3 ~ poly(vdht, degree = 2) +\n                   poly(sbtp, degree = 2) + \n                   poly(ibht, degree = 2), data = ozone)\n##\nplot(lm.ozone.quad, which = 1)\nplot(lm.ozone.quad, which = 3)\n\n\n## ----edaLogOzone-----------------------------------------\npairs(log(upo3) ~ vdht + sbtp + ibht, data = ozone, \n      upper.panel = panel.smooth)\n\n\n## ----plotLogOzone----------------------------------------\nlm.ozone.log.quad <- update(lm.ozone.quad, log(upo3) ~ .)\nformula(lm.ozone.log.quad )\n##\n##\nplot(lm.ozone.log.quad, which = 1)\nplot(lm.ozone.log.quad, which = 3)\n\n\n## ----qqLmLogOZone, message=FALSE-------------------------\nlibrary(plgraphics)\nplregr(lm.ozone.log.quad ,\n       plotselect = c(default = 0,\n                      qq = 2),\n       xvar = FALSE)\n\n\n## ----LeverageLogQuaOzone---------------------------------\nplot(lm.ozone.log.quad, which = 5)\n\n\n## ----summaryLmLOgOzon------------------------------------\nsummary(lm.ozone.log.quad)\n\n\n## ----fitOzoneModel---------------------------------------\nlm.ozone.simple <- lm(log(upo3) ~ sbtp, data = ozone)\nsummary(lm.ozone.simple)\n\n\n## ----expCoeff--------------------------------------------\nexp(coef(lm.ozone.simple)[\"sbtp\"]) %>% \n  print(digits = 3)\n\n\n## ----lmFarms---------------------------------------------\nlm.farms <- lm(log(revenue)~ log(expenditure) + region + industry,\n               data = d.farms)\nsummary(lm.farms)\n\n\n## ----CoefFarms-------------------------------------------\ncoef(lm.farms)[\"log(expenditure)\"]\n\n\n## ----predictBack-----------------------------------------\nexp(fitted(lm.ozone.log.quad)[1:5])\n\n\n## ----echo=FALSE, message=FALSE---------------------------\n## (this chunk is not echoed and messages are omitted)\n##\ngg.sbtp <- ggplot(data = ozone,\n                  mapping = aes(y = log(upo3),\n                                x = sbtp)) +\n  geom_point() + geom_smooth()\ngg.sbtp.log <- gg.sbtp + aes(x = log(sbtp))\n##\nrequire(gridExtra)\ngrid.arrange(gg.sbtp, gg.sbtp.log)\n\n\n## ----sessionINfo, size='footnotesize'--------------------\nsessionInfo()\n\n"}